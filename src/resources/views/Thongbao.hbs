<main class="app-content">
  <div class="app-title">
    <ul class="app-breadcrumb breadcrumb side">
      <li class="breadcrumb-item active"><a href="#"><b>Thông báo</b></a></li>
    </ul>
    <div id="clock"></div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="tile">
        <div class="tile-body">
          <div class="row element-button">
            <div class="col-sm-2">
              <button type="button" id="add-new-btn" class="btn btn-add btn-sm"> <i class="fas fa-plus"></i> Thêm
                mới</button>
            </div>

            <div class="col-sm-2">
              <a class="btn btn-delete btn-sm" type="button" title="Xóa" onclick="myFunction(this)"><i
                  class="fas fa-trash-alt"></i> Xóa tất cả </a>
            </div>
            <div class="end" style="margin-left: 640px;  ">
          
  <div class="row">
    <div class="col-sm-22" style="margin-left: 20px; font-weight: bold; font-size: 15px;">
      <label class="control-label1">Từ ngày</label>
      <input class="form-control1" id="tuNgay" name='Từ ngày' type="date" required>
    </div>
    <div class="col-sm-22" style="margin-left: 20px;font-weight: bold; font-size: 15px;">
      <label class="control-label1">Đến ngày</label>
      <input class="form-control1" id="denNgay" name='Đến ngày' type="date" required>
    </div>
    <div class="col-sm-22" style="margin-left: 20px;">
      <a class="btn btn-tim-kiem" id="timKiem" name='Tìm kiếm' href="" title="button" style="color: #fff; background-color: #38a927; width: 80px; height: 30px; display: flex; justify-content: center;
        align-items: center;">Tìm kiếm</a>
    </div>
  </div>

            </div>
          </div>

          <form action="/product/create_data" id="product-form" method="post" enctype="multipart/form-data"
            style="display: none;">

            <div class="row">
              <div class="form-group col-md-3" style="margin-left: 20px;">
                <label class="control-label">Tiêu đề</label>
                <input class="form-control" type="text">
              </div>
              <div class="form-group col-md-3">
                <label class="control-label">Ảnh </label>
                <div id="myfileupload">
                  <input type="file" id="uploadfile" name="ImageUpload" onchange="readURL(this);" />
                </div>
                <div id="boxchoice">
                  <a href="javascript:" class="Choicefile"><i class="fas fa-cloud-upload-alt"></i> Chọn ảnh</a>
                  <p style="clear:both"></p>
                </div>
              </div>


              <div class="row">
                <div class="form-group col-md-3" style="margin-left: 32px;">
                  <label class="control-label">Thông tin</label>
                  <textarea class="form-control" name="mota" id="mota"
                    style=" height: 20px; width: 1350px;; "></textarea>
                  <script>CKEDITOR.replace('mota');</script>
                </div>
              </div>
            </div>
            <div style="margin-left: 18px;">
              <button class="btn btn-save" type="button">Lưu lại</button>
              <a class="btn btn-cancel" href="/khuyenmai">Hủy bỏ</a>
            </div>
        </div>

      </div>

      </form>
      <div class="row element-button">
      </div>
      <table class="table table-hover table-bordered" id="sampleTable">
        <thead>
          <tr>
            <th width="10">STT</th>
            <th>Tiêu đề</th>
            <th>Ảnh</th>
            <th>Nội dung</th>
            <th>Ngày đăng</th>
            <th width="100">Chức năng</th>
          </tr>
        </thead>
        <tbody>
          {{#each data}}
          <tr>
            <td>{{@index}}</td>
            <td>{{this.TieuDe}}</td>
            <td><img src="/images/{{this.HinhAnh}}" alt=""></td>
            <td>{{this.NoiDung}}</td>
            <td class="NgayDang" style="width: 150px;">{{this.createdAt}}</td>
            <td><button class="btn btn-primary btn-sm trash" type="button" title="Xóa" onclick="myFunction(this)"><i
                  class="fas fa-trash-alt"></i>
              </button>
              <button class="btn btn-primary btn-sm edit" type="button" title="Sửa" id="show-emp" data-toggle="modal"
                data-target="#ModalUP"><i class="fas fa-edit"></i></button>

            </td>
          </tr>
          {{/each }}


        </tbody>
      </table>
    </div>
  </div>
  </div>
  </div>
</main>
<div class="modal fade" id="ModalUP" tabindex="-1" role="dialog" aria-hidden="true" data-backdrop="static"
  data-keyboard="false">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">

      <div class="modal-body">
        <div class="row">
          <div class="form-group  col-md-12">
            <span class="thong-tin-thanh-toan">
              <h5>Chỉnh sửa thông tin Voucher</h5>
            </span>
          </div>
        </div>
        <div class="row">
          <div class="form-group col-md-6">
            <label class="control-label">MÃ</label>
            <input class="form-control" type="text" required value="">
          </div>
          <div class="form-group col-md-6">
            <label class="control-label">Tiêu đề</label>
            <input class="form-control" type="text" required value="">
          </div>
          <div class="form-group col-md-6 ">
            <label class="control-label">GIÁ TRỊ giảm</label>
            <select class="form-control" id="exampleSelect1" style=" padding-left: 100px;">
              <option>50.000vnđ</option>
              <option>100.000vnđ</option>
              <option>150.000vnđ</option>
              <option>250.000vnđ</option>
              <option>300.000vnđ</option>
              <option>350.000vnđ</option>
            </select>
          </div>

          <div class="form-group col-md-6">
            <label class="control-label">Ngày bắt đầu</label>
            <input class="form-control" type="date" required>
          </div>
          <div class="form-group col-md-6">
            <label class="control-label">Ngày kết thúc</label>
            <input class="form-control" type="date" required>
          </div>
          <div class="form-group col-md-6">
            <label class="control-label">Mô tả xe</label>
            <textarea class="form-control" name="mota" id="mota" style=" height: 20px; width: 200px; "></textarea>
            <script>CKEDITOR.replace('mota');</script>
          </div>

          <div class="form-group col-md-12">
            <label class="control-label">Ảnh xe</label>
            <div id="myfileupload">
              <input type="file" id="uploadfile" name="ImageUpload" onchange="readURL(this);" />
            </div>

            <div id="boxchoice">
              <a href="javascript:" class="Choicefile"><i class="fas fa-cloud-upload-alt"></i> Chọn ảnh</a>
              <p style="clear:both"></p>

            </div>

          </div>



        </div>
        <div class="row element-button">
        </div>
        <button class="btn btn-save" type="button">Lưu lại</button>
        <a class="btn btn-cancel" data-dismiss="modal" href="#">Hủy bỏ</a>
        <BR>
      </div>
      <div class="modal-footer">
      </div>
    </div>
  </div>
</div>

<script>
  const table = document.getElementById('sampleTable');
  const fromDateInput = document.getElementById('tuNgay');
  const toDateInput = document.getElementById('denNgay');
  const searchButton = document.getElementById('timKiem');
  searchButton.addEventListener('click', filterTable);

  function filterTable() {
    const fromDate = new Date(fromDateInput.value);
    const toDate = new Date(toDateInput.value);

    const rows = table.querySelectorAll('tbody tr');
    for (const row of rows) {
      const createdAtElement = row.querySelector('.NgayDang');
      const createdAtText = createdAtElement.textContent;
      const createdAtDate = new Date(createdAtText);

      if (createdAtDate instanceof Date) {
        if (createdAtDate >= fromDate && createdAtDate <= toDate) {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      } else {
        // Handle the case where createdAtDate is NaN
        row.style.display = ''; // Show the row even if the date is not in a supported format
      }
    }
  }
</script>
<script>
  // ẩn hiện form
  const addNewBtn = document.getElementById("add-new-btn");
  let showForm = false;

  addNewBtn.addEventListener("click", () => {
    showForm = !showForm; // Đảo ngược giá trị của biến showForm
    const form = document.getElementById("product-form");
    form.style.display = showForm ? "block" : "none"; // Hiện hoặc ẩn form tùy thuộc vào giá trị của biến showForm
  });

  const btnUpdate = document.querySelectorAll(".btnupdate");
  const form = document.getElementById("product-form");
  btnUpdate.forEach((btn) => {
    btn.addEventListener("click", () => {
      form.style.display = "block";

      const row = btn.closest("tr");
      const id = row.cells[0].textContent;
      const name = row.cells[1].textContent;
      const image = row.cells[2].querySelector("img").src;
      const soluong = row.cells[3].textContent;
      const status = row.cells[4].textContent;
      const price = row.cells[5].textContent;
      const loai = row.cells[6].textContent;
      console.log(soluong, price, image);

      document.getElementById("id").value = id;
      document.getElementById("name").value = name;
      document.getElementById("quantity").value = soluong;
      document.getElementById("status").value = status;
      document.getElementById("price").value = price;
      document.getElementById("category").value = loai;
      document.getElementById("image").value = image;
      document.body.scrollTop = 0; // cho Safari
      document.documentElement.scrollTop = 0;
    });
  });

</script>
<!-- Essential javascripts for application to work-->
<script src="/public/js/jquery-3.2.1.min.js"></script>
<script src="/public/js/popper.min.js"></script>
<script src="/public/js/bootstrap.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="src/jquery.table2excel.js"></script>
<script src="/publicjs/main.js"></script>
<!-- The javascript plugin to display page loading on top-->
<script src="/public/js/plugins/pace.min.js"></script>
<!-- Page specific javascripts-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js"></script>
<!-- Data table plugin-->
<script type="text/javascript" src="/public/js/plugins/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/public/js/plugins/dataTables.bootstrap.min.js"></script>
<script type="text/javascript">$('#sampleTable').DataTable();</script>
<script>
  const HSD = document.querySelectorAll(".NgayDang");
  HSD.forEach((i) => {
    const date = new Date(i.innerHTML);
    const day = date.getDate();
    const month = date.getMonth() + 1;
    const year = date.getFullYear();
    const formattedDate = day + '/' + month + '/' + year
    i.innerHTML = formattedDate
  })

  $("#show-emp").on("click", function () {
    $("#ModalUP").modal({ backdrop: false, keyboard: false })
  });
</script>